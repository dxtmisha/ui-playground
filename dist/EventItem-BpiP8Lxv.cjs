"use strict";var m=Object.defineProperty;var c=(r,t,e)=>t in r?m(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var s=(r,t,e)=>(c(r,typeof t!="symbol"?t+"":t,e),e);const l=require("./object-D6teWcGS.cjs"),n=require("./element-B5HRaKMF.cjs");class a{constructor(t,e=["click"],i,h,o){s(this,"element");s(this,"elementControl");s(this,"elementControlEdit");s(this,"type");s(this,"listenerRecent",t=>{var e,i;n.isInDom(this.elementControl)?((e=this.listener)==null||e.call(this.element,t,this.detail),l.isObject(this.options)&&((i=this.options)!=null&&i.once)&&this.stop()):this.stop()});s(this,"activity",!1);s(this,"activityItems",[]);this.listener=i,this.options=h,this.detail=o,this.element=n.getElementOrWindow(t),this.elementControl=n.getElement(t),this.type=l.toArray(e)}isActive(){return this.activity}setElement(t){const e=n.getElementOrWindow(t);return this.elementControlEdit||(this.elementControl=n.getElement(t)),this.element=e,this.reset(),this}setElementControl(t){return this.elementControl=n.getElement(t),this.elementControlEdit=!l.isNull(this.elementControl),this.elementControlEdit||(this.elementControl=n.getElement(this.element)),this}setType(t){return this.type=l.toArray(t),this.reset(),this}setListener(t){return this.listener=t,this}setOptions(t){return this.options=t,this.reset(),this}setDetail(t){return this.detail=t,this}dispatch(t=this.detail){return this.type.forEach(e=>{var i;return(i=this.element)==null?void 0:i.dispatchEvent(new CustomEvent(e,{detail:t}))}),this}start(){return this.activity||(this.activity=!0,this.activityItems=[],this.type.forEach(t=>{this.element&&!(t==="resize"&&this.makeResize())&&!(t==="scroll-sync"&&this.makeScroll())&&(this.element.addEventListener(t,this.listenerRecent,this.options),this.activityItems.push({element:this.element,type:t}))})),this}stop(){return this.activity&&(this.activity=!1,this.activityItems.forEach(({element:t,type:e,listener:i,observer:h})=>{h?h.disconnect():i?t==null||t.removeEventListener(e,i):t==null||t.removeEventListener(e,this.listenerRecent)})),this}toggle(t){return t?this.start():this.stop()}reset(){return this.activity&&(this.stop(),this.start()),this}isObserver(){return"ResizeObserver"in window}makeResize(){if(this.element&&this.element instanceof HTMLElement&&this.element!==document.body&&this.isObserver()){const t=new ResizeObserver(e=>this.listenerRecent(e==null?void 0:e[0]));return t.observe(this.element),this.activityItems.push({element:this.element,type:"resize",observer:t}),!0}return!1}makeScroll(){if(this.element){let t=!1;const e=i=>{t||(t=!0,requestAnimationFrame(()=>{this.listenerRecent(i),t=!1}))};return this.element.addEventListener("scroll",e,this.options),this.element.addEventListener("resize",e,this.options),this.activityItems.push({element:this.element,type:"scroll",listener:e},{element:this.element,type:"resize",listener:e}),!0}return!1}}exports.EventItem=a;

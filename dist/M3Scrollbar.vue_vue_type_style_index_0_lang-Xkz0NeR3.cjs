"use strict";var d=Object.defineProperty;var m=(s,t,e)=>t in s?d(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var i=(s,t,e)=>(m(s,typeof t!="symbol"?t+"":t,e),e);const r=require("vue"),g=require("./DesignConstructorAbstract-C1iC14vk.cjs"),c=require("./element-sZ6iCo-N.cjs"),v=require("./DataStorage-B2lBLB9T.cjs"),f=require("./EventItem-CkoNUiAw.cjs");class n{static async is(){const t=await this.get();return t!==-1&&t<=8}static async get(){const t=this.storage.get()??-1;if(!this.calculate&&t===-1){const e=await this.init();return this.storage.set(e),e}return t}static createElement(){return c.createElement(document.body,"div",t=>{t.style.height="24px",t.style.overflowY="scroll",t.style.position="fixed",t.style.width="100%",c.createElement(t,"div",e=>{e.style.height="100px"})})}static init(){return new Promise(t=>{this.calculate=!0;const e=this.createElement();requestAnimationFrame(()=>{t(e.offsetWidth-e.clientWidth),e.remove(),this.calculate=!1})})}}i(n,"storage",new v.DataStorage("scrollbar",!0)),i(n,"calculate",!1);const h=8;class w{constructor(t,e,a){i(this,"event");i(this,"top",!1);i(this,"bottom",!1);this.props=t,this.element=e,this.callback=a}getClasses(){return{"??--border--top":this.top,"??--border--bottom":this.bottom}}start(){return this.event?this.event.start():this.event=new f.EventItem(this.element.value,["scroll-sync"],()=>this.on()).start(),this.on(),this}stop(){return this.event&&this.event.stop(),this}toggle(){return this.props.border?this.start():this.stop(),this}reset(){return this.event&&this.event.setElement(this.element.value),this.toggle()}setData(t,e){return(this.top!==t||this.bottom!==e)&&(this.top=t,this.bottom=e,this.callback&&this.callback()),this}on(){const t=this.element.value;t&&this.setData(t.scrollTop>h,t.scrollTop<t.scrollHeight-t.clientHeight-h)}}class y{constructor(t,e,a){i(this,"border");this.border=new w(t,e,a)}async getClasses(){return{"??--disabled":await this.getDisabled(),...this.border.getClasses()}}async getDisabled(){return await n.is()}}class S{constructor(t,e){i(this,"scrollbar");i(this,"classes",r.ref({}));this.scrollbar=new y(t,e,()=>this.updateClasses().then()),r.watchEffect(async()=>{this.scrollbar.border.reset(),await this.updateClasses()}),r.onMounted(async()=>{await r.nextTick(),requestAnimationFrame(()=>this.scrollbar.border.toggle())})}async updateClasses(){return this.classes.value=await this.scrollbar.getClasses(),this}}class C extends g.DesignConstructorAbstract{constructor(e,a,o){super(e,a,o);i(this,"scrollbar");this.scrollbar=new S(this.props,this.element),this.init()}makeOptions(){return this}initSetup(){return{}}initExpose(){return{}}initClasses(){return{main:{...this.toClassName(this.scrollbar.classes.value)}}}initStyles(){return{}}initRender(){const e=this.setup(),a=[this.initSlot("default")];return r.h(this.props.tag,{...this.getAttrs(),ref:this.element,class:e.classes.value.main},a)}}const B={tag:"div"},k={tag:{type:String,default:B.tag},visible:Boolean,border:Boolean,inverse:Boolean},x={...k,visible:Boolean,border:Boolean,inverse:Boolean},D=r.defineComponent({name:"M3Scrollbar",__name:"M3Scrollbar",props:{...x},setup(s,{expose:t,emit:e}){const a=e,o=s,u=r.computed(()=>({main:{"m3-scrollbar":!0,"m3-scrollbar--visible":o.visible,"m3-scrollbar--border":o.border,"m3-scrollbar--inverse":o.inverse}})),b=r.computed(()=>({})),l=new C("m3.scrollbar",o,{emits:a,classes:u,styles:b}),p=l.render();return t(l.expose()),(E,_)=>(r.openBlock(),r.createBlock(r.unref(p)))}});exports._sfc_main=D;

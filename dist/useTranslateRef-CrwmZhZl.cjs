"use strict";var j=Object.defineProperty;var B=(r,t,e)=>t in r?j(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var c=(r,t,e)=>(B(r,typeof t!="symbol"?t+"":t,e),e);const T=require("./CacheItem-CMrGJ4bG.cjs"),i=require("vue"),l=require("./GeoIntl-CejZ34l7.cjs"),n=require("./string-C-Ov7RqZ.cjs"),U=require("./Datetime-Cw-goJzK.cjs"),W=require("./EventItem-BpiP8Lxv.cjs"),N=require("./Icons-BbnTXRrJ.cjs"),u=require("./object-D6teWcGS.cjs"),q=require("./useEnv-C3O1y5Ow.cjs"),M=require("./DataStorage-D5dAt6Kg.cjs");class x{constructor(){c(this,"cache",{})}get(t,e,s){return this.getCacheItem(t,e).getCache(s??[])}async getAsync(t,e,s){return await this.getCacheItem(t,e).getCacheAsync(s??[])}getCacheItem(t,e){return t in this.cache||(this.cache[t]=new T.CacheItem(e)),this.cache[t]}}const R=class R{static get(t,e,s){return this.cache.get(t,e,s)}};c(R,"cache"),R.cache=new x;let F=R;const O="cookie-block";class ${static get(){return this.storage.get()??!1}static set(t){this.storage.set(t)}}c($,"storage",new M.DataStorage(O));const w={};class b{constructor(t){c(this,"value");c(this,"options",{});if(this.name=t,t in C)return C[t];this.value=w==null?void 0:w[t],C[t]=this}get(t,e){return this.value===void 0&&t&&this.set(t,e),this.value}set(t,e){this.value=u.executeFunction(t),Object.assign(this.options,e),this.update()}remove(){this.set("")}getAge(){var t;return((t=this.options)==null?void 0:t.age)??q.useEnv("cache")??7*24*60*60}update(){var t,e;if(!$.get()){const s=String(this.value??"");document.cookie=[`${encodeURIComponent(this.name)}=${encodeURIComponent(s)}`,`max-age=${s===""?"-1":this.getAge()}`,`SameSite=${((t=this.options)==null?void 0:t.sameSite)??"strict"}`,...((e=this.options)==null?void 0:e.arguments)??[]].join("; ")}}}(()=>{for(const t of document.cookie.split(";")){const[e,s]=t.trim().split("=");e&&u.isFilled(s)&&(w[e]=u.transformation(s))}})();const C={};class G{constructor(t,e="date",s=l.Geo.getLocation()){c(this,"item");c(this,"type");c(this,"code");c(this,"date");c(this,"datetime");c(this,"year",i.computed(()=>this.date.value&&this.datetime.getYear()));c(this,"month",i.computed(()=>this.date.value&&this.datetime.getMonth()));c(this,"day",i.computed(()=>this.date.value&&this.datetime.getDay()));c(this,"hour",i.computed(()=>this.date.value&&this.datetime.getHour()));c(this,"minute",i.computed(()=>this.date.value&&this.datetime.getMinute()));c(this,"second",i.computed(()=>this.date.value&&this.datetime.getSecond()));this.item=n.toRefItem(t),this.type=n.toRefItem(e),this.code=n.toRefItem(s),this.date=i.ref(l.toDate(this.item.value)),this.datetime=new U.Datetime(this.date.value,this.type.value,this.code.value),i.watch(this.item,a=>{this.date.value=l.toDate(a)}),i.watch(this.type,a=>this.datetime.setType(a)),i.watch(this.code,a=>this.datetime.setCode(a)),i.watch(this.date,a=>this.datetime.setDate(a)),this.datetime.setWatch(()=>i.triggerRef(this.date))}getItem(){return this.item}getDate(){return this.date}getDatetime(){return this.datetime}getHoursType(){return i.computed(()=>this.date.value&&this.datetime.getHoursType())}getFirstDayCode(){return i.computed(()=>this.date.value&&this.datetime.getFirstDayCode())}getYear(){return this.year}getMonth(){return this.month}getDay(){return this.day}getHour(){return this.hour}getMinute(){return this.minute}getSecond(){return this.second}getMaxDay(){return i.computed(()=>this.date.value&&this.datetime.getMaxDay())}locale(t=this.type.value,e){return i.computed(()=>this.date.value&&this.datetime.locale(t,e))}standard(t=!0){return i.computed(()=>this.date.value&&this.datetime.standard(t))}}class Y extends W.EventItem{constructor(t,e,s=["click"],a,o,p){const y=n.toRefItem(t),k=n.toRefItem(e);super(y.value,s,a,o,p),k.value&&this.setElementControl(k.value),i.watch(y,L=>this.setElement(L)),i.watch(k,L=>this.setElementControl(L))}}const h=class h{static get(){return this.item}static getCountry(){return this.country}static getLanguage(){return this.language}static getStandard(){return this.standard}static getFirstDay(){return this.firstDay}static set(t){l.Geo.set(t,!0),this.item.value=l.Geo.getItem()}};c(h,"item",i.shallowRef(l.Geo.get())),c(h,"country",i.computed(()=>h.item.value.country)),c(h,"language",i.computed(()=>h.item.value.language)),c(h,"standard",i.computed(()=>h.item.value.standard)),c(h,"firstDay",i.computed(()=>h.item.value.firstDay));let v=h;class Z{constructor(t=l.Geo.getLocation()){c(this,"code");c(this,"flag");this.code=n.toRefItem(t),this.flag=new N.GeoFlag(this.code.value),i.watch(this.code,e=>this.flag.setCode(e))}getCode(){return this.code}get(t=this.code.value){return i.computed(()=>this.flag.get(t))}getFlag(t=this.code.value){return i.computed(()=>{var e;return(e=this.flag.get(t))==null?void 0:e.icon})}getList(t){return i.computed(()=>this.flag.getList(t))}getNational(t){return i.computed(()=>this.flag.getNational(t))}}class H{constructor(t){c(this,"location");c(this,"intl");this.location=n.toRefItem(t),this.intl=i.computed(()=>new l.GeoIntl(this.location.value??v.getLanguage().value))}display(t,e){return i.computed(()=>this.intl.value.display(n.getRef(t),e))}languageName(t,e){return i.computed(()=>this.intl.value.languageName(n.getRef(t),e))}countryName(t,e){return i.computed(()=>this.intl.value.countryName(n.getRef(t),e))}number(t,e){return i.computed(()=>this.intl.value.number(n.getRef(t),e))}decimal(){return i.computed(()=>this.intl.value.decimal())}currency(t,e,s=!1){return i.computed(()=>this.intl.value.currency(n.getRef(t),e,s))}unit(t,e){return i.computed(()=>this.intl.value.unit(n.getRef(t),e))}percent(t,e){return i.computed(()=>this.intl.value.percent(n.getRef(t),e))}percentBy100(t,e){return i.computed(()=>this.intl.value.percentBy100(n.getRef(t),e))}date(t,e,s,a){return i.computed(()=>this.intl.value.date(n.getRef(t),e,s,a))}relative(t,e,s){return i.computed(()=>this.intl.value.relative(n.getRef(t),e,s))}relativeLimit(t,e,s,a,o,p,y){return i.computed(()=>this.intl.value.relativeLimit(n.getRef(t),e,s,a,o,p,y))}month(t,e){return i.computed(()=>this.intl.value.month(n.getRef(t),e))}months(t){return i.computed(()=>this.intl.value.months(t))}weekday(t,e){return i.computed(()=>this.intl.value.weekday(n.getRef(t),e))}weekdays(t){return i.computed(()=>this.intl.value.weekdays(t))}time(t){return i.computed(()=>this.intl.value.time(n.getRef(t)))}}const m=class m{static get(t){return this.list.find(e=>t===e.value)}static getByPhone(t){let e=this.map,s,a="";return this.toNumber(t).forEach(o=>{a===""&&o in e?(s=e[o],e=e[o].next):a+=o}),{item:s,phone:a}}static getList(){return this.list}static getMap(){return this.map}static toMask(t,e){if(u.isFilled(t)&&Array.isArray(e)&&e.length>0){const s=this.removeZero(t),a=s.length;for(const o of e)if(this.getUnnecessaryLength(o)===a)return this.toStandard(s,o)}}static removeZero(t){return t.match(/^0/)?t.replace(/^0/,""):t.match(/^89/)?t.replace(/^8/,""):t}static getUnnecessaryLength(t){return t.replace(/[^*]+/ig,"").length}static makeList(){const t=u.forEach(l.Geo.getList(),e=>{if(e!=null&&e.phoneMask)return{phone:(e==null?void 0:e.phoneCode)&&parseInt(e.phoneCode)||void 0,mask:u.toArray(e.phoneMask),value:e.country}});this.list=t.sort((e,s)=>e.phone-s.phone)}static makeMap(){this.list.forEach(t=>{t.mask.forEach(e=>{let s=this.map,a;this.toNumber(e).forEach(o=>{o in s||(s[o]={items:[],info:void 0,value:void 0,mask:[],maskFull:[],next:{}}),a=s[o],s=s[o].next}),a&&(a.value===void 0&&(a.info=t,a.value=t.value),a.mask.push(e),a.maskFull.push(e.replace(/\d/ig,"*")),a.items.push(t))})})}static toNumber(t){return t.replace(/\D+/ig,"").split("")}static toStandard(t,e){let s=0;return e.replace(/\*/ig,()=>t[s++])}};c(m,"list",[]),c(m,"map",{}),m.makeList(),m.makeMap();let A=m;const g=class g{static get(t,e){return!(t in this.hash)&&e&&this.set(t,e),this.hash[t]}static set(t,e){var a;const s=u.executeFunction(e);s!==((a=this.hash)==null?void 0:a[t])&&(this.hash[t]=s,this.update())}static addWatch(t,e){t in this.watch?this.watch[t].push(e):this.watch={[t]:[e]}}static getLocation(){const t={};return location.hash.replace(/([\w-]+)[:=]([^;]+)/ig,(...e)=>(t[e[1]]=u.transformation(e[2]),"")),t}static update(){this.block=!0;const t=u.forEach(this.hash,(e,s)=>`${s}=${encodeURIComponent(String(e))}`);t.sort(),history.replaceState(null,"",`#${t.join(";")}`),requestAnimationFrame(()=>{this.block=!1})}static reload(){if(!this.block){const t=this.getLocation();this.makeWatch(t),this.hash=t}}static makeWatch(t){u.forEach(this.watch,(e,s)=>{var a;((a=this.hash)==null?void 0:a[s])!==(t==null?void 0:t[s])&&e.forEach(o=>o(t[s]))})}};c(g,"hash",{}),c(g,"watch",{}),c(g,"block",!1),g.reload(),addEventListener("hashchange",()=>g.reload());let f=g;class d{static async get(t){var s;const e=this.getName(t);return e in this.data?this.data[e]:(await this.add(t),((s=this.data)==null?void 0:s[e])??t)}static getSync(t){const e=this.getName(t);return e in this.data?this.data[e]:t}static async getList(t){return new Promise(e=>{const s={};let a=0;for(const o of t)this.get(o).then(p=>{s[o]=p,++a>=t.length&&e(s)})})}static add(t){return new Promise(e=>{this.cache.push(...u.toArray(t)),this.resolveList.push(e),this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.timeout=void 0,this.make().then(()=>{this.resolveList.forEach(s=>s()),this.resolveList=[]})},160)})}static getName(t){return`${l.Geo.getLocation()}-${t}`}static async getResponse(){const t=N.Api.isLocalhost()?this.urlLocalhost:this.url,e=await N.Api.response({path:t,request:{list:this.cache}});return(e==null?void 0:e.data)??{}}static async make(){const t=await this.getResponse();this.cache.forEach(e=>{this.data[this.getName(e)]=(t==null?void 0:t[e])??""}),this.cache=[]}}c(d,"url",q.useEnv("apiTranslate")),c(d,"urlLocalhost","translate.json"),c(d,"data",{}),c(d,"cache",[]),c(d,"resolveList",[]),c(d,"timeout");function K(r,t,e){if(r in I)return I[r];const s=new b(r),a=i.ref(s.get(t,e));return i.watch(a,o=>{s.set(o,e)}),I[r]=a,a}const I={};function z(r,t){if(r in D)return D[r];const e=i.shallowRef(f.get(r,t));return i.watch(e,s=>f.set(r,s)),f.addWatch(r,s=>{e.value=s}),D[r]=e,e}const D={};function J(r,t){if(r in E)return E[r];const e=new M.DataStorage(r,!0),s=i.shallowRef(e.get(t));return i.watch(s,a=>e.set(a)),E[r]=s,s}const E={};function Q(r,t,e){if(r in S)return S[r];const s=new M.DataStorage(r),a=i.shallowRef(s.get(t,e));return i.watch(a,o=>s.set(o)),S[r]=a,a}const S={};function X(r){const t=i.shallowRef({});return i.watchEffect(async()=>{v.getLanguage()&&(t.value=await d.getList(r))}),t}exports.Cache=x;exports.CacheStatic=F;exports.Cookie=b;exports.CookieBlock=$;exports.DatetimeRef=G;exports.EventRef=Y;exports.GeoFlagRef=Z;exports.GeoIntlRef=H;exports.GeoPhone=A;exports.GeoRef=v;exports.Hash=f;exports.Translate=d;exports.useCookieRef=K;exports.useHashRef=z;exports.useSessionRef=J;exports.useStorageRef=Q;exports.useTranslateRef=X;
